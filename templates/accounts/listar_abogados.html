{% extends "base.html" %}
{% block content %}
<div class="container-fluid px-3 px-md-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="h4 mb-0">Abogados</h3>
    {% if request.user.es_superuser or request.user.es_administrador or request.user.is_superuser %}
      <a class="btn btn-primary btn-sm" href="{% url 'accounts:crear_abogado' %}">
        <i class="bi bi-person-plus"></i> Nuevo abogado
      </a>
    {% endif %}
  </div>

  <div class="card shadow-sm border-0">
    <div class="table-responsive">
      <table class="table align-middle">
      <thead class="table-light">
        <tr>
          <th>Usuario</th>
          <th>Nombre</th>
          <th>Email</th>
          {% if request.user.es_administrador or request.user.is_superuser %}
            <th class="text-center">Acciones</th>
          {% endif %}
        </tr>
      </thead>
      <tbody>
      {% for a in abogados %}
        <tr>
          <td>{{ a.username }}</td>
          <td>{{ a.get_full_name|default:"—" }}</td>
          <td>{{ a.email|default:"—" }}</td>

          {% if request.user.es_administrador or request.user.is_superuser %}
            <td class="text-center">
              {% if a.rol != "ADMINISTRADOR" %}
                <a href="{% url 'accounts:editar_abogado' a.id %}" class="btn btn-outline-secondary btn-sm">
                  <i class="bi bi-pencil"></i> Editar
                </a>
              {% else %}
                <span class="text-muted small">—</span>
              {% endif %}
            </td>
          {% endif %}
        </tr>
      {% empty %}
        <tr><td colspan="4" class="text-center text-muted">Sin abogados registrados.</td></tr>
      {% endfor %}
      </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
